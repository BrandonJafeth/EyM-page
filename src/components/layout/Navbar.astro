---
import { Image } from 'astro:assets';
import siteData from '../../data/site.json';
import NavbarMobile from './NavbarMobile';

const links = [
  { text: 'Inicio', href: '/' },
  { text: 'Sobre Nosotros', href: '/sobre-nosotros' },
  { text: 'Servicios', href: '/servicios' },
  { text: 'Contacto', href: '/contacto' },
];

const currentPath = Astro.url.pathname;
const isHomePage = currentPath === '/';

// Always solid background
const headerClass = "fixed top-0 w-full z-50 transition-all duration-300 bg-[#091723] text-white border-b border-[rgba(203,213,224,0.1)] h-20 shadow-md";
---

<header id="navbar" class={headerClass} data-is-home={isHomePage}>
  <div class="px-6 md:px-[120px] h-full">
    <div class="flex items-center justify-between h-full transition-all duration-300" id="navbar-container">
      <a href="/" class="flex-shrink-0 group flex items-center gap-4">
        <img 
          src={siteData.logo} 
          alt={siteData.name} 
          class="h-12 w-auto object-contain transition-transform duration-300 group-hover:scale-105"
        />
      </a>

      <!-- Desktop Menu -->
      <nav class="hidden md:flex items-center gap-14">
        {links.map(link => {
          const isActive = link.href === '/' ? currentPath === '/' : currentPath.startsWith(link.href);
          return (
            <a
              href={link.href}
              class="relative group py-3"
            >
              <span
                class:list={[
                  "font-heading text-base tracking-[0.5px] font-normal transition-colors",
                  isActive ? "text-[#AF9232]" : "text-white"
                ]}
              >
                {link.text}
              </span>
              {/* Active/Hover underline */}
               <div
                class:list={[
                  "absolute bottom-0 left-0 right-0 h-[2px] transition-all duration-300 bg-[#AF9232]",
                  isActive ? "opacity-100" : "opacity-0 group-hover:opacity-100"
                ]}
              ></div>
            </a>
          );
        })}
      </nav>

      <!-- CTA Button -->
      <div class="hidden md:block">
        <a 
          href="/contacto" 
          class="group font-heading text-base text-white border border-[#AF9232] bg-transparent hover:bg-[#AF9232] hover:text-[#091723] px-8 py-3 rounded-[2px] tracking-[0.05em] transition-all duration-300 cursor-pointer inline-block"
        >
          CONTACTAR
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <!-- Se pasa 'client:load' para que el componente React sea interactivo inmediatamente -->
      <NavbarMobile 
        client:load 
        navLinks={links} 
        currentPath={currentPath} 
        socialLinks={siteData.social}
      />
    </div>
  </div>
</header>